model_version: "1.0"
dashboard:
  id: campaign-performance
  name: Campaign Performance
  description: Track campaign ROI, lead generation, and channel effectiveness.
  widgets:
    - id: active-campaigns-kpi
      type: kpi
      title: Active Campaigns
      query: fct_campaign_status
      query_config:
        model: fct_campaign_status
        parameters:
          - name: project_id
            type: integer
            required: true
        filters:
          project_id: ":project_id"
          status: active
      options:
        comparison:
          interval: "30d"

    - id: total-spend-kpi
      type: kpi
      title: Total Spend (MTD)
      query: fct_campaign_spend
      query_config:
        model: fct_campaign_spend
        parameters:
          - name: project_id
            type: integer
            required: true
        filters:
          project_id: ":project_id"
      options:
        format: currency
        comparison:
          interval: "30d"

    - id: leads-generated-trend
      type: timeseries
      title: Leads Generated by Week
      query: fct_campaign_leads
      query_config:
        model: fct_campaign_leads
        parameters:
          - name: project_id
            type: integer
            required: true
        filters:
          project_id: ":project_id"
        order_by:
          - lead_week
      visualization:
        x: lead_week
        y: lead_count
        series: campaign_type

    - id: channel-roi
      type: leaderboard
      title: ROI by Channel
      query: fct_campaign_roi
      query_config:
        model: fct_campaign_roi
        parameters:
          - name: project_id
            type: integer
            required: true
        filters:
          project_id: ":project_id"
      visualization:
        group_by: channel
        value: roi_percentage
        format: percentage

    - id: cost-per-lead-trend
      type: timeseries
      title: Cost per Lead Trend
      query: fct_campaign_efficiency
      query_config:
        model: fct_campaign_efficiency
        parameters:
          - name: project_id
            type: integer
            required: true
        filters:
          project_id: ":project_id"
        order_by:
          - period
      visualization:
        x: period
        y: cost_per_lead
        format: currency

    - id: campaign-performance-table
      type: table
      title: Campaign Performance Summary
      query: fct_campaign_summary
      query_config:
        model: fct_campaign_summary
        parameters:
          - name: project_id
            type: integer
            required: true
        filters:
          project_id: ":project_id"
        select:
          - campaign_name
          - channel
          - status
          - spend
          - leads_generated
          - cost_per_lead
          - conversion_rate
        order_by:
          - leads_generated DESC
        limit: 20

    - id: content-engagement
      type: leaderboard
      title: Top Content by Engagement
      query: fct_content_engagement
      query_config:
        model: fct_content_engagement
        parameters:
          - name: project_id
            type: integer
            required: true
        filters:
          project_id: ":project_id"
      visualization:
        group_by: content_title
        value: engagement_score

    - id: funnel-conversion
      type: table
      title: Marketing Funnel Conversion
      query: fct_marketing_funnel
      query_config:
        model: fct_marketing_funnel
        parameters:
          - name: project_id
            type: integer
            required: true
        filters:
          project_id: ":project_id"
        select:
          - stage
          - count
          - conversion_to_next
          - drop_off_rate
        order_by:
          - stage_order

  alerts:
    - query: fct_campaign_efficiency
      query_config:
        model: fct_campaign_efficiency
        parameters:
          - name: project_id
            type: integer
            required: true
        filters:
          project_id: ":project_id"
        order_by:
          - period DESC
        limit: 1
      condition: cost_per_lead > target_cpl * 1.5
      notify_roles:
        - manager
      message: "Cost per lead is 50% above target"

    - query: fct_campaign_spend
      query_config:
        model: fct_campaign_spend
        parameters:
          - name: project_id
            type: integer
            required: true
        filters:
          project_id: ":project_id"
      condition: spend_percentage > 0.90
      notify_roles:
        - manager
      message: "Campaign budget is 90% consumed"
